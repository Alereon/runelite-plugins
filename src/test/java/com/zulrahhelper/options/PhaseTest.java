package com.zulrahhelper.options;

import com.sun.org.apache.xerces.internal.impl.dv.util.Base64;
import com.zulrahhelper.ImageOptions;
import com.zulrahhelper.ImageOrientation;
import com.zulrahhelper.Phase;
import org.junit.Assert;
import org.junit.Test;

import javax.imageio.ImageIO;
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;

import static com.zulrahhelper.options.Attack.*;

public class PhaseTest {
    @Test
    public void testGenerateImage() throws IOException {
        Phase phase = Phase
                .builder(Phase.Rotation.NORMAL, 10)
                .addAttack(NORMAL_10)
                .addAttack(VENOM_4)
                .addAttack(SNAKELING_4)
                .setMagePray()
                .setRangedPray()
                .build();

        ImageOptions opts = new ImageOptions();
        opts.setDarkMode(false);
        opts.setAttackIcons(true);
        opts.setPrayerIcons(true);
        opts.setOrientation(ImageOrientation.SOUTH);

        BufferedImage img = phase.getImage(opts);

        String imgBase64 = toBase64(img);
        File out = toFile(img);

        Desktop desktop = Desktop.getDesktop();
        desktop.open(out);
        Assert.assertEquals(img64, imgBase64);
    }

    // base64 -w 0 /tmp/applyToPhase.png | xclip -selection clipboard
    private static final String img64 = "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";

    private String toBase64(BufferedImage img) throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ImageIO.write(img, "png", baos);
        byte[] bytes = baos.toByteArray();
        return Base64.encode(bytes);
    }

    private File toFile(BufferedImage img) throws IOException {
        File out = new File("/tmp/applyToPhase.png");
        ImageIO.write(img, "png", out);
        return out;
    }
}
